# 3장 템플릿

### 템플릿
- 바뀌는 성질이 다른 코드 중에서 변경이 거의 일어나지 않으며 일정한 패턴으로 유지되는 특성을 가진 부분을 자유롭게 변경되는 성질을 가진 부분으로부터 독립시켜서 효과적으로
  활용할 수 있도록 하는 방법.

***

## 3.1 다시 보는 초난감 DAO

### 3.1.1 예외처리 기능을 갖춘 DAO

- 이러한 JDBC 코드에서는 어떤 상황에서도 가져온 리소스를 반환하도록 try/catch/finally 구문 사용 권장.

***

## 3.2 변하는 것과 변하지 않는 것


### try/catch/finally 문제점
- 중첩되고, 모든 메소드마다 반복된다.

### 3.2.2 분리와 재사용을 위한 디자인 패턴 적용.

#### 템플릿 메소드 패턴의 적용
- 상속을 통해 기능을 확장해서 사용하는 부분.
- 변하지 않는 부분은 슈퍼클래스에 두고 변하는 부분은 추상 메소드로 정의해둬서 서브클래스에서 오버라이드하여 새롭게 정의해 쓰도록 하는 것이다.


이러한 방법은 DAO 로직마다 상속을 통해 새로운 클래스를 만들어야 한다.

### 전략 패턴의 적용.

- 개방 폐쇄 원칙을 잘 지키는 구조이면서도 템플릿 메소드 패턴보다 유연하고 확장성이 뛰어난 것이, 오브젝트를 아예 둘로 분리하고 클래스 레벨에서는 인터페이스를 통해서만
  의존하도록 만드는 전략 패턴.

컨텍스트가 인터페이스 뿐만 아니라 특정 구현 클래스를 직접 알고 있다는 건, 전략 패턴에도 OCP에도 잘 들어맞는다고 볼 수 없다.

### DI 적용을 위한 클라이언트 / 컨텍스트 분리

> 마이크로 DI
> > 의존관계 주입의 가장 중요한 개념은 제 3자의 도움을 통해 두 오브젝트 사이의 유연한 관계가 설정되도록 만드는 것이다.



***

## 3.3 JDBC 전략 패턴의 최적화.


### 3.3.2 전략과 클라이언트의 동거

문제점
- DAO 메소드마다 새로운 StatementStrategy 구현 클래스르 만들어야 한다는 점 -> 클래스 파일의 개수가 많이 늘어난다.
- 부가적인 정보가 있는 경우, 이를 위해 오브젝트를 전달받는 생성자와 이를 저장해둘 인스턴스 변수를 번거롭게 만들어야 한다는 점.


### 로컬클래스
- 클래스 파일이 많아지는 문제의 간단한 해결 방법. 클래스 안에 내부 클래스로 정의해버리는 것이다.


> 중첩클래스의 종류 (다른 클래스 내부에 정의되는 클래스)
> > 독립적으로 오브젝트로 만들어 질 수 있는 ***스태틱 클래스***   
> > 자신이 정의된 클래스의 오브젝트 안에서만 만들어질 수 있는 ***내부 클래스***


***
## 3.4 컨텍스트와 DI


### 스프링 빈으로 DI

> 인터페이스를 사용하지 않고 DI를 적용하는 것은 문제가 없을까? 236p
- 인터페이스를 사이에 둬서 클래스레벨에서는 의존관계가 고정되지 않게 하고, 런타임 시에 의존할 오브젝트와의 관계를 다이나믹 하게 주입해주는것이 맞다.
- 그러나 스프링의 DI는 넓게 보자면 객체의 생성과 관계설정에 대해 제어권한을 오브젝트에서 제거하고 외부로 위임했다는 IoC 라는 개념을 포괄한다.


***
## 3.5 템플릿과 콜백


### 템플릿 콜백 패턴

- 템플릿-콜백패턴이란 결국 전략패턴의 변형된 형태라고 봐야합니다.  전략패턴의 기본적 구조에 변화되는 부분을 매번 클래스로 만들지 않고, '익명 내부 클래스' 바로 생성하여 이용합니다.






